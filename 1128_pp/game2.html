<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>MINI GAME - ì£¼ì—°ì´ì˜ ëŒë ¤ëŒë ¤ëŒë¦¼íŒ</title>

    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Pretendard", system-ui, -apple-system, BlinkMacSystemFont,
          sans-serif;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        background: radial-gradient(
          circle at top left,
          #ff9f9f 0,
          #7a0028 40%,
          #2b0010 100%
        );
        background-size: 160% 160%;
        animation: stage-bg 10s infinite alternate;
        color: #fff;
        transition: background 0.6s ease;
      }

      @keyframes stage-bg {
        0% {
          background-position: 0% 0%;
        }
        100% {
          background-position: 100% 100%;
        }
      }

      /* ê²Œì„ ëª¨ë“œì¼ ë•Œ ë°°ê²½ ë” í™”ë ¤í•˜ê²Œ */
      body.game-mode {
        background: radial-gradient(
          circle at top,
          #ffeb3b 0,
          #ff4081 30%,
          #7c4dff 60%,
          #1b0036 100%
        );
        background-size: 200% 200%;
        animation: game-bg 8s infinite alternate;
      }

      @keyframes game-bg {
        0% {
          background-position: 0% 50%;
        }
        100% {
          background-position: 100% 50%;
        }
      }

      /* ì  íŒ¨í„´ ì˜¤ë²„ë ˆì´ */
      .dot-overlay {
        position: fixed;
        inset: 0;
        background-image: radial-gradient(
          rgba(255, 255, 255, 0.15) 1px,
          transparent 1px
        );
        background-size: 12px 12px;
        opacity: 0.4;
        pointer-events: none;
        z-index: 1;
      }

      .container {
        position: relative;
        z-index: 5;
        width: 95%;
        max-width: 760px;
        background: rgba(255, 255, 255, 0.12);
        border-radius: 30px;
        box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
        padding: 28px 24px 24px;
        border: 2px solid rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(12px);
      }

      h1 {
        margin: 0;
        font-size: 40px;
        text-align: center;
        letter-spacing: 4px;
        font-weight: 900;
        text-shadow: 0 4px 0 rgba(0, 0, 0, 0.5);
      }

      .subtitle {
        text-align: center;
        margin-top: 10px;
        font-size: 20px;
        font-weight: 700;
      }

      .small-sub {
        text-align: center;
        margin-top: 6px;
        font-size: 15px;
        opacity: 0.9;
        font-weight: 600;
      }

      /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1. STAGE PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #stagePage {
        margin-top: 24px;
        text-align: center;
      }

      .stage-buttons {
        margin-top: 26px;
        display: flex;
        justify-content: center;
        gap: 18px;
        flex-wrap: wrap;
      }

      .stage-btn {
        background: #ffffff;
        color: #b0003a;
        border-radius: 999px;
        padding: 12px 30px;
        border: none;
        font-size: 18px;
        font-weight: 900;
        cursor: pointer;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }

      .stage-btn:hover {
        transform: translateY(-3px) scale(1.03);
        box-shadow: 0 14px 26px rgba(0, 0, 0, 0.45);
      }

      /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2. GAME PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #gamePage {
        display: none;
        margin-top: 18px;
      }

      .game-wrapper {
        display: flex;
        gap: 18px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .game-left {
        flex: 1.2;
        min-width: 320px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.15),
          rgba(255, 255, 255, 0.05)
        );
        border-radius: 24px;
        padding: 18px;
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.5);
        position: relative;
        overflow: hidden;
      }

      .game-left::before {
        content: "";
        position: absolute;
        width: 260px;
        height: 260px;
        border-radius: 50%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.6),
          transparent 60%
        );
        top: -120px;
        right: -80px;
        opacity: 0.35;
        pointer-events: none;
      }

      .hud {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 10px;
        font-size: 15px;
        font-weight: 800;
      }

      .hud span.label {
        opacity: 0.9;
      }

      .hud .value {
        font-weight: 900;
      }

      .hud-pill {
        background: rgba(0, 0, 0, 0.25);
        padding: 6px 10px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      /* ìºë¦­í„° ì´ë¯¸ì§€ */
      .character-wrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 4px;
      }

      .character-label {
        font-size: 14px;
        font-weight: 700;
        margin-bottom: 6px;
      }

      .character-frame {
        width: 140px;
        height: 140px;
        border-radius: 20px;
        background: #1a0f2e;
        border: 3px solid #ffd54f;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        box-shadow: 0 8px 18px rgba(0, 0, 0, 0.6);
      }

      .character-frame img {
        max-width: 130px;
        max-height: 130px;
        image-rendering: pixelated;
      }

      .char-dance {
        animation: charDance 0.7s ease 2;
      }

      @keyframes charDance {
        0% {
          transform: translateY(0);
        }
        25% {
          transform: translateY(-8px);
        }
        50% {
          transform: translateY(0);
        }
        75% {
          transform: translateY(-5px);
        }
        100% {
          transform: translateY(0);
        }
      }

      /* ë£°ë › ì› */
      .roulette-wrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 10px;
      }

      .roulette-circle {
        width: 130px;
        height: 130px;
        border-radius: 50%;
        background: radial-gradient(
          circle at 30% 30%,
          #fff8e1,
          #ffeb3b,
          #ff9800
        );
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 46px;
        font-weight: 900;
        color: #c62828;
        text-shadow: 0 2px 0 rgba(255, 255, 255, 0.9),
          0 4px 0 rgba(0, 0, 0, 0.4);
        border: 5px solid #fffde7;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.9),
          0 10px 20px rgba(0, 0, 0, 0.7);
      }

      @keyframes glow {
        0% {
          box-shadow: 0 0 10px rgba(255, 255, 255, 0.8),
            0 10px 20px rgba(0, 0, 0, 0.6);
        }
        100% {
          box-shadow: 0 0 26px rgba(255, 255, 255, 1),
            0 10px 26px rgba(0, 0, 0, 0.8);
        }
      }

      .roulette-glow {
        animation: glow 0.22s infinite alternate;
      }

      .btn-row {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin-top: 16px;
      }

      .game-btn {
        padding: 12px 26px;
        border-radius: 16px;
        border: none;
        font-size: 18px;
        font-weight: 900;
        cursor: pointer;
        color: #fff;
        text-shadow: 0 2px 0 rgba(0, 0, 0, 0.4);
        box-shadow: 0 8px 18px rgba(0, 0, 0, 0.6);
        transition: transform 0.12s ease, box-shadow 0.12s ease,
          filter 0.12s ease;
        min-width: 110px;
      }

      .btn-even {
        background: linear-gradient(135deg, #40c4ff, #2962ff);
      }
      .btn-odd {
        background: linear-gradient(135deg, #ff4081, #d500f9);
      }

      .game-btn:hover:not(:disabled) {
        transform: translateY(-3px);
        box-shadow: 0 12px 22px rgba(0, 0, 0, 0.8);
        filter: brightness(1.05);
      }

      .game-btn:disabled {
        opacity: 0.45;
        cursor: default;
        box-shadow: none;
      }

      .status-text {
        margin-top: 10px;
        min-height: 22px;
        font-size: 14px;
        text-align: center;
        font-weight: 600;
      }

      /* ê¸°ë¡íŒ */
      .game-right {
        flex: 0.8;
        min-width: 200px;
        background: rgba(9, 0, 24, 0.8);
        border-radius: 24px;
        padding: 14px;
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.7);
        border: 2px solid rgba(255, 255, 255, 0.4);
      }

      .record-title {
        font-size: 17px;
        font-weight: 900;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .record-box {
        background: rgba(0, 0, 0, 0.45);
        border-radius: 16px;
        padding: 10px;
        max-height: 340px;
        overflow-y: auto;
        font-size: 14px;
      }

      .record-item {
        margin-bottom: 6px;
        font-weight: 700;
      }

      .record-item span.round {
        color: #ffeb3b;
      }

      .win-text {
        color: #69f0ae;
      }
      .lose-text {
        color: #ff5252;
      }

      /* ì—”ë”© ì˜¤ë²„ë ˆì´ */
      #endingOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.75);
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
        z-index: 20;
      }

      .ending-box {
        width: 95%;
        max-width: 480px;
        background: radial-gradient(circle at top, #fffde7, #ffe0e0);
        color: #880e4f;
        border-radius: 26px;
        padding: 26px 22px;
        text-align: center;
        box-shadow: 0 16px 40px rgba(0, 0, 0, 0.8);
        border: 3px solid #ffffff;
      }

      .ending-main {
        font-size: 26px;
        font-weight: 900;
        margin-bottom: 4px;
      }

      .ending-sub {
        font-size: 19px;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .ending-info {
        font-size: 14px;
        color: #4a148c;
        margin-bottom: 16px;
      }

      .restart-btn {
        background: linear-gradient(135deg, #ff4081, #c51162);
        color: #fff;
        border: none;
        border-radius: 20px;
        padding: 10px 26px;
        font-size: 18px;
        font-weight: 900;
        cursor: pointer;
        text-shadow: 0 2px 0 rgba(0, 0, 0, 0.4);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.7);
      }

      .restart-btn:hover {
        transform: translateY(-2px);
      }

      /* ëª¨ë°”ì¼ ëŒ€ì‘ */
      @media (max-width: 600px) {
        h1 {
          font-size: 32px;
        }
        .subtitle {
          font-size: 17px;
        }
        .small-sub {
          font-size: 13px;
        }
        .container {
          padding: 22px 18px 18px;
        }
      }
    </style>
  </head>

  <body>
    <div class="dot-overlay"></div>

    <div class="container">
      <h1>MINI GAME</h1>
      <div class="subtitle">ì£¼ì—°ì´ì˜ ëŒë ¤ëŒë ¤ëŒë¦¼íŒ ğŸ¡</div>
      <div class="small-sub" id="topSubText">ìŠ¤í…Œì´ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”!</div>

      <!-- â”€â”€â”€â”€â”€ STAGE SELECT PAGE â”€â”€â”€â”€â”€ -->
      <div id="stagePage">
        <div class="stage-buttons">
          <button class="stage-btn" onclick="selectStage(1)">Stage 1</button>
          <button class="stage-btn" onclick="selectStage(2)">Stage 2</button>
          <button class="stage-btn" onclick="selectStage(3)">Stage 3</button>
        </div>
      </div>

      <!-- â”€â”€â”€â”€â”€ GAME PAGE â”€â”€â”€â”€â”€ -->
      <div id="gamePage">
        <div class="game-wrapper">
          <!-- LEFT : GAME AREA -->
          <div class="game-left">
            <div class="hud">
              <div class="hud-pill">
                <span class="label">Round</span>
                <span class="value" id="round">1</span><span>/ 10</span>
              </div>
              <div class="hud-pill">
                <span class="label">ìŠ¹</span>
                <span class="value" id="wins">0</span>
                <span class="label">íŒ¨</span>
                <span class="value" id="losses">0</span>
              </div>
              <div class="hud-pill">
                ğŸ’° <span class="value" id="cash">1000</span>
              </div>
            </div>

            <div class="character-wrap">
              <div class="character-label" id="stageLabel">
                Stage 1 - Fire Mage
              </div>
              <div class="character-frame">
                <!-- ì´ ì„¸ íŒŒì¼ì„ ê°™ì€ í´ë”ì— ì €ì¥: wizard.png, knight.png, demon.png -->
                <img id="characterImg" src="" alt="character" />
              </div>
            </div>

            <div class="roulette-wrap">
              <div id="resultCircle" class="roulette-circle">?</div>
              <div class="btn-row">
                <button id="evenBtn" class="game-btn btn-even" disabled>
                  ì§ (EVEN)
                </button>
                <button id="oddBtn" class="game-btn btn-odd" disabled>
                  í™€ (ODD)
                </button>
              </div>
              <div id="statusText" class="status-text">ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”!</div>
            </div>
          </div>

          <!-- RIGHT : RECORD LIST -->
          <div class="game-right">
            <div class="record-title">ğŸ“œ ë¼ìš´ë“œ ê¸°ë¡</div>
            <div id="recordList" class="record-box">
              <!-- [R1] WIN / LOSE ê°€ ì—¬ê¸°ì— ìŒ“ì„ -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€â”€â”€â”€ ENDING OVERLAY â”€â”€â”€â”€â”€ -->
    <div id="endingOverlay">
      <div class="ending-box">
        <div id="endingMain" class="ending-main">ê²°ê³¼</div>
        <div id="endingSub" class="ending-sub"></div>
        <div id="endingInfo" class="ending-info"></div>
        <button class="restart-btn" onclick="location.reload()">
          ğŸ”„ RESTART
        </button>
      </div>
    </div>

    <script>
      // ===== ê²Œì„ ìƒíƒœ ë³€ìˆ˜ =====
      let round = 1;
      let wins = 0;
      let losses = 0;
      let cash = 1000;
      let rouletteSpeed = 120;
      let playing = false;
      let rouletteTimer = null;
      let selectedStage = null;

      // ===== DOM ìš”ì†Œ =====
      const bodyEl = document.body;
      const topSubText = document.getElementById("topSubText");
      const stagePage = document.getElementById("stagePage");
      const gamePage = document.getElementById("gamePage");
      const roundEl = document.getElementById("round");
      const winsEl = document.getElementById("wins");
      const lossesEl = document.getElementById("losses");
      const cashEl = document.getElementById("cash");
      const characterImg = document.getElementById("characterImg");
      const stageLabel = document.getElementById("stageLabel");
      const resultCircle = document.getElementById("resultCircle");
      const statusText = document.getElementById("statusText");
      const recordList = document.getElementById("recordList");
      const evenBtn = document.getElementById("evenBtn");
      const oddBtn = document.getElementById("oddBtn");
      const endingOverlay = document.getElementById("endingOverlay");
      const endingMain = document.getElementById("endingMain");
      const endingSub = document.getElementById("endingSub");
      const endingInfo = document.getElementById("endingInfo");

      // ===== ìŠ¤í…Œì´ì§€ë³„ ì„¤ì • =====
      const STAGE_CONFIG = {
        1: {
          name: "Stage 1 - Fire Mage ğŸ”¥",
          speed: 130,
          img: "wizard.png",
        },
        2: {
          name: "Stage 2 - Golden Knight âš”ï¸",
          speed: 90,
          img: "knight.png",
        },
        3: {
          name: "Stage 3 - Demon Monster ğŸ‘¾",
          speed: 60,
          img: "demon.png",
        },
      };

      // ìŠ¤í…Œì´ì§€ ì„ íƒ ì‹œ ì‹¤í–‰
      function selectStage(stage) {
        if (!STAGE_CONFIG[stage]) return;

        selectedStage = stage;
        const cfg = STAGE_CONFIG[stage];

        rouletteSpeed = cfg.speed;
        stageLabel.textContent = cfg.name;
        characterImg.src = cfg.img;
        characterImg.alt = cfg.name;

        stagePage.style.display = "none";
        gamePage.style.display = "block";
        bodyEl.classList.add("game-mode");
        topSubText.textContent = "í™€(ODD) ë˜ëŠ” ì§(EVEN)ì„ ì„ íƒí•´ ë³´ì„¸ìš”!";

        evenBtn.disabled = false;
        oddBtn.disabled = false;
        statusText.textContent = "ğŸ’¡ ë¼ìš´ë“œë‹¹ 100 ìºì‹œê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.";
      }

      // ê³µí†µ UI ì—…ë°ì´íŠ¸
      function updateUI() {
        roundEl.textContent = round;
        winsEl.textContent = wins;
        lossesEl.textContent = losses;
        cashEl.textContent = cash;
      }

      // ê¸°ë¡ ì¶”ê°€
      function addRecord(isWin) {
        const item = document.createElement("div");
        item.classList.add("record-item");

        const text = isWin
          ? '<span class="win-text">WIN ğŸ‰</span>'
          : '<span class="lose-text">LOSE ğŸ’¥</span>';

        item.innerHTML = `<span class="round">[R${round}]</span> â†’ ${text}`;
        recordList.appendChild(item);
      }

      evenBtn.addEventListener("click", () => playRound("even"));
      oddBtn.addEventListener("click", () => playRound("odd"));

      // í•œ ë¼ìš´ë“œ ì‹¤í–‰
      function playRound(choice) {
        if (playing) return;
        if (round > 10) return;

        if (cash < 100) {
          alert("ìºì‹œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤! (ë¼ìš´ë“œë‹¹ 100 ìºì‹œ í•„ìš”)");
          return;
        }

        playing = true;

        // ë¼ìš´ë“œ ì‹œì‘ ì‹œ ê¸°ë³¸ ë°°íŒ… 100 ìºì‹œ ì°¨ê°
        cash -= 100;
        updateUI();

        statusText.textContent = "ğŸ° ë£°ë ›ì´ ëŒì•„ê°€ëŠ” ì¤‘ì…ë‹ˆë‹¤...";
        resultCircle.classList.add("roulette-glow");

        // ë£°ë › í…ìŠ¤íŠ¸ ë²ˆê°ˆì•„ê°€ë©° í‘œì‹œ
        let toggle = true;
        rouletteTimer = setInterval(() => {
          resultCircle.textContent = toggle ? "ì§" : "í™€";
          toggle = !toggle;
        }, rouletteSpeed);

        // 1.2ì´ˆ ë’¤ ì‹¤ì œ ê²°ê³¼ í™•ì •
        setTimeout(() => {
          clearInterval(rouletteTimer);
          resultCircle.classList.remove("roulette-glow");

          const real = Math.random() < 0.5 ? "even" : "odd";
          const isWin = real === choice;

          resultCircle.textContent = real === "even" ? "ì§" : "í™€";

          if (isWin) {
            wins++;
            cash += 150;
            statusText.textContent = "ğŸ‰ ì •ë‹µ! +150 ìºì‹œ!";
            // ìºë¦­í„° ì í”„ ì• ë‹ˆë©”ì´ì…˜
            characterImg.classList.add("char-dance");
            setTimeout(() => characterImg.classList.remove("char-dance"), 800);
            addRecord(true);
          } else {
            losses++;
            statusText.textContent = "ğŸ’¥ í‹€ë ¸ìŠµë‹ˆë‹¤!";
            addRecord(false);
          }

          updateUI();
          round++;

          // 10ë¼ìš´ë“œë¥¼ ëª¨ë‘ ëëƒˆì„ ë•Œ ìë™ ì¢…ë£Œ
          if (round > 10) {
            finishGame();
          } else {
            playing = false;
          }
        }, 1200);
      }

      // 10ë¼ìš´ë“œ í›„ ìµœì¢… ê²°ê³¼
      function finishGame() {
        // ìŠ¹ì´ ë” ë§ìœ¼ë©´ win, ì•„ë‹ˆë©´(ê°™ê±°ë‚˜ ë” ì ìœ¼ë©´) lose
        if (wins > losses) {
          endingMain.textContent = "ğŸ‰ ë‹¹ì‹ ì´ ì´ê²¼ì–´ìš”!";
          endingSub.textContent = "5000 ìºì‹œë¥¼ ì–»ì—ˆì–´ìš”!";
          cash += 5000;
        } else {
          endingMain.textContent = "ğŸ˜¢ ì•„ì‰½ê²Œ ì¡Œì–´ìš”...";
          endingSub.textContent = "-1000 ìºì‹œ";
          cash -= 1000;
        }

        updateUI();

        endingInfo.textContent = `ìµœì¢… ì „ì : ìŠ¹ ${wins} / íŒ¨ ${losses} | ë‚¨ì€ ìºì‹œ: ${cash}`;
        endingOverlay.style.display = "flex";

        // ë” ì´ìƒ í”Œë ˆì´ ëª» í•˜ê²Œ ë²„íŠ¼ ë¹„í™œì„±í™”
        evenBtn.disabled = true;
        oddBtn.disabled = true;
        playing = false;
      }
    </script>
  </body>
</html>
